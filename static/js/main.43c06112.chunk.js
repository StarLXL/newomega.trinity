(this["webpackJsonpmy-react-app"]=this["webpackJsonpmy-react-app"]||[]).push([[0],{471:function(e,t,n){e.exports=n(516)},477:function(e,t,n){},493:function(e,t,n){},494:function(e,t,n){},495:function(e,t,n){},496:function(e,t,n){},497:function(e,t,n){},498:function(e,t,n){},499:function(e,t){},514:function(e){e.exports=JSON.parse('[{"inputs":[{"internalType":"uint16","name":"index","type":"uint16"},{"internalType":"uint16","name":"cp","type":"uint16"},{"internalType":"uint16","name":"hp","type":"uint16"},{"internalType":"uint16","name":"attackBase","type":"uint16"},{"internalType":"uint16","name":"attackVariable","type":"uint16"},{"internalType":"uint16","name":"defence","type":"uint16"},{"internalType":"uint16","name":"speed","type":"uint16"},{"internalType":"uint16","name":"range","type":"uint16"},{"internalType":"uint16","name":"agility","type":"uint16"}],"name":"addShip","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16[]","name":"selectionLhs","type":"uint16[]"},{"internalType":"uint16[]","name":"selectionRhs","type":"uint16[]"},{"internalType":"uint16","name":"commanderLhs","type":"uint16"},{"internalType":"uint16","name":"commanderRhs","type":"uint16"}],"name":"fight","outputs":[{"components":[{"internalType":"uint16[]","name":"selectionLhs","type":"uint16[]"},{"internalType":"uint16[]","name":"selectionRhs","type":"uint16[]"},{"internalType":"uint16","name":"commanderLhs","type":"uint16"},{"internalType":"uint16","name":"commanderRhs","type":"uint16"},{"components":[{"internalType":"string","name":"moveType","type":"string"},{"internalType":"uint16","name":"round","type":"uint16"},{"internalType":"uint16","name":"source","type":"uint16"},{"internalType":"uint16","name":"target","type":"uint16"},{"internalType":"int16","name":"targetPosition","type":"int16"},{"internalType":"uint64","name":"damage","type":"uint64"}],"internalType":"struct Move[]","name":"lhs","type":"tuple[]"},{"components":[{"internalType":"string","name":"moveType","type":"string"},{"internalType":"uint16","name":"round","type":"uint16"},{"internalType":"uint16","name":"source","type":"uint16"},{"internalType":"uint16","name":"target","type":"uint16"},{"internalType":"int16","name":"targetPosition","type":"int16"},{"internalType":"uint64","name":"damage","type":"uint64"}],"internalType":"struct Move[]","name":"rhs","type":"tuple[]"},{"internalType":"int64[]","name":"lhsHp","type":"int64[]"},{"internalType":"int64[]","name":"rhsHp","type":"int64[]"},{"internalType":"bool","name":"lhsDead","type":"bool"},{"internalType":"bool","name":"rhsDead","type":"bool"},{"internalType":"uint16","name":"rounds","type":"uint16"}],"internalType":"struct FightResult","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getShips","outputs":[{"components":[{"internalType":"uint16","name":"cp","type":"uint16"},{"internalType":"uint16","name":"hp","type":"uint16"},{"components":[{"internalType":"uint16","name":"base","type":"uint16"},{"internalType":"uint16","name":"variable","type":"uint16"}],"internalType":"struct ShipVariableStat","name":"attack","type":"tuple"},{"internalType":"uint16","name":"defence","type":"uint16"},{"internalType":"uint16","name":"speed","type":"uint16"},{"internalType":"uint16","name":"range","type":"uint16"},{"internalType":"uint16","name":"agility","type":"uint16"}],"internalType":"struct Ship[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"}]')},515:function(e){e.exports=JSON.parse('[{"inputs":[{"internalType":"contract GameEngine","name":"engine","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"attacker","type":"address"},{"indexed":true,"internalType":"address","name":"defender","type":"address"},{"components":[{"internalType":"uint16[]","name":"selectionLhs","type":"uint16[]"},{"internalType":"uint16[]","name":"selectionRhs","type":"uint16[]"},{"internalType":"uint16","name":"commanderLhs","type":"uint16"},{"internalType":"uint16","name":"commanderRhs","type":"uint16"},{"components":[{"internalType":"string","name":"moveType","type":"string"},{"internalType":"uint16","name":"round","type":"uint16"},{"internalType":"uint16","name":"source","type":"uint16"},{"internalType":"uint16","name":"target","type":"uint16"},{"internalType":"int16","name":"targetPosition","type":"int16"},{"internalType":"uint64","name":"damage","type":"uint64"}],"internalType":"struct Move[]","name":"lhs","type":"tuple[]"},{"components":[{"internalType":"string","name":"moveType","type":"string"},{"internalType":"uint16","name":"round","type":"uint16"},{"internalType":"uint16","name":"source","type":"uint16"},{"internalType":"uint16","name":"target","type":"uint16"},{"internalType":"int16","name":"targetPosition","type":"int16"},{"internalType":"uint64","name":"damage","type":"uint64"}],"internalType":"struct Move[]","name":"rhs","type":"tuple[]"},{"internalType":"int64[]","name":"lhsHp","type":"int64[]"},{"internalType":"int64[]","name":"rhsHp","type":"int64[]"},{"internalType":"bool","name":"lhsDead","type":"bool"},{"internalType":"bool","name":"rhsDead","type":"bool"},{"internalType":"uint16","name":"rounds","type":"uint16"}],"indexed":false,"internalType":"struct FightResult","name":"result","type":"tuple"}],"name":"FightComplete","type":"event"},{"inputs":[{"internalType":"address","name":"enemy","type":"address"},{"internalType":"uint16[]","name":"selection","type":"uint16[]"},{"internalType":"uint16","name":"commander","type":"uint16"}],"name":"attack","outputs":[{"components":[{"internalType":"uint16[]","name":"selectionLhs","type":"uint16[]"},{"internalType":"uint16[]","name":"selectionRhs","type":"uint16[]"},{"internalType":"uint16","name":"commanderLhs","type":"uint16"},{"internalType":"uint16","name":"commanderRhs","type":"uint16"},{"components":[{"internalType":"string","name":"moveType","type":"string"},{"internalType":"uint16","name":"round","type":"uint16"},{"internalType":"uint16","name":"source","type":"uint16"},{"internalType":"uint16","name":"target","type":"uint16"},{"internalType":"int16","name":"targetPosition","type":"int16"},{"internalType":"uint64","name":"damage","type":"uint64"}],"internalType":"struct Move[]","name":"lhs","type":"tuple[]"},{"components":[{"internalType":"string","name":"moveType","type":"string"},{"internalType":"uint16","name":"round","type":"uint16"},{"internalType":"uint16","name":"source","type":"uint16"},{"internalType":"uint16","name":"target","type":"uint16"},{"internalType":"int16","name":"targetPosition","type":"int16"},{"internalType":"uint64","name":"damage","type":"uint64"}],"internalType":"struct Move[]","name":"rhs","type":"tuple[]"},{"internalType":"int64[]","name":"lhsHp","type":"int64[]"},{"internalType":"int64[]","name":"rhsHp","type":"int64[]"},{"internalType":"bool","name":"lhsDead","type":"bool"},{"internalType":"bool","name":"rhsDead","type":"bool"},{"internalType":"uint16","name":"rounds","type":"uint16"}],"internalType":"struct FightResult","name":"result","type":"tuple"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"gameEngine","outputs":[{"internalType":"contract GameEngine","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getAllDefenders","outputs":[{"components":[{"internalType":"address","name":"player","type":"address"},{"internalType":"bool","name":"isInitialised","type":"bool"},{"internalType":"uint16[]","name":"defenceSelection","type":"uint16[]"},{"internalType":"uint16","name":"commander","type":"uint16"},{"internalType":"string","name":"name","type":"string"}],"internalType":"struct PlayerDefence[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getLeaderboard","outputs":[{"components":[{"internalType":"address","name":"player","type":"address"},{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"wins","type":"uint256"},{"internalType":"uint256","name":"losses","type":"uint256"}],"internalType":"struct LeaderboardEntry[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getOwnDefence","outputs":[{"components":[{"internalType":"address","name":"player","type":"address"},{"internalType":"bool","name":"isInitialised","type":"bool"},{"internalType":"uint16[]","name":"defenceSelection","type":"uint16[]"},{"internalType":"uint16","name":"commander","type":"uint16"},{"internalType":"string","name":"name","type":"string"}],"internalType":"struct PlayerDefence","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint16[]","name":"defence","type":"uint16[]"},{"internalType":"uint16","name":"commander","type":"uint16"},{"internalType":"string","name":"name","type":"string"}],"name":"registerDefence","outputs":[],"stateMutability":"nonpayable","type":"function"}]')},516:function(e,t,n){"use strict";n.r(t);var a=n(522),i=n(16),s=n.n(i),r=n(463),o=n.n(r),c=n(18),l=n.n(c),m=n(267),u=n(324),p=n(25),d=n(26),h=n(36),y=n(37),f=(n(477),n(405)),v=(n(433),n(110)),g=n(53),b=n(190),E=n(42),T=(n(427),[{name:"Frigate",asset:"assets/frigate/",description:"Cheap, quick and agile, the frigate can be used as a quick strike weapon, able to reach enemy lines quickest. Can not withstand much heat though.",stats:{cp:1,hp:1e3,attack:{base:30,variable:5},defence:2,speed:4,range:4,agility:25},scale:1,combatScale:.6,visuals:{beamColor:new E.h(0,1,0),beamWidth:Math.PI/256}},{name:"Cruiser",asset:"assets/cruiser/",description:"As lightest of the heavier ships, the cruiser retains some of the speed and maneuverability of the frigate while offering big improvements in the hull and weaponry.",stats:{cp:4,hp:4e3,attack:{base:100,variable:20},defence:12,speed:3,range:7,agility:15},scale:6,combatScale:.4,visuals:{beamColor:new E.h(.2,.2,1),beamWidth:Math.PI/96}},{name:"Destroyer",asset:"assets/destroyer/",description:"The destroyer is an effective killing machine, providing both effective support and serving as an artillery line raining heavy damage on enemy ships.",stats:{cp:5,hp:5e3,attack:{base:130,variable:10},defence:15,speed:2,range:8,agility:10},scale:9,combatScale:.5,visuals:{beamColor:new E.h(1,1,1),beamWidth:Math.PI/96}},{name:"Battleship",asset:"assets/battleship/",description:"Fitted with state of the art weaponry and protection, the battleship is the ultimate fighting force in the galaxy.",stats:{cp:15,hp:1e4,attack:{base:200,variable:5},defence:20,speed:1,range:8,agility:0},scale:12,combatScale:.6,visuals:{beamColor:new E.h(1,0,1),beamWidth:Math.PI/64}}]),S=function(){function e(){Object(p.a)(this,e)}return Object(d.a)(e,[{key:"displayLoadingUI",value:function(){window.document.getElementById("omegaLoadingScreen").style.display="block"}},{key:"hideLoadingUI",value:function(){window.document.getElementById("omegaLoadingScreen").style.display="none"}}]),e}(),w=(n(493),function(e){var t=Object(i.useState)(0),n=Object(v.a)(t,2),a=n[0],r=n[1],o=Object(i.useState)(g.a.map(T,(function(){return 0}))),c=Object(v.a)(o,2),l=c[0],m=c[1],u=Object(i.useState)(0),p=Object(v.a)(u,2),d=p[0],h=p[1],y=Object(i.useState)(null),f=Object(v.a)(y,2),w=f[0],k=f[1],N=Object(i.useState)([]),C=Object(v.a)(N,2),M=C[0],O=C[1],x=Object(i.useState)(!1),L=Object(v.a)(x,2),D=L[0],I=L[1],j=Object(i.useState)(!1),P=Object(v.a)(j,2),R=P[0],A=P[1],B=function(e){return g.a.reduce(e,(function(e,t,n){return e+(t||0)*T[n].stats.cp}),0)},F=function(){e.onDone(l)},_=function(e){return new Promise((function(t,n){var a=[],i=new E.e(e);g.a.each(T,(function(e,t){i.addMeshTask(t,"",T[t].asset,"scene.gltf").onSuccess=function(e){var n,i;a[t]=e.loadedMeshes,n=e.loadedMeshes,i=t,n[0].position=E.w.Zero(),n[0].rotation=new E.w(-Math.PI/12,Math.PI,0),n[0].scalingDeterminant=.001*T[i].scale,n[0].isVisible=!1}})),i.onFinish=function(e){O(a),t(a)},i.load()}))},H=function(e,t,n){var a=n||M;g.a.each(t.meshes,(function(e){e.isVisible=!1})),g.a.each(a[e],(function(e){e.isVisible=!0}))},V="addOrRemoveShip addShip ".concat(R?"highlightOverModal":"");return s.a.createElement("div",{className:"ShipSelection"},s.a.createElement(b.a,{antialias:!0,adaptToDeviceRatio:!0,canvasId:"ship-selection"},s.a.createElement(b.b,{onSceneMount:function(e){var t=e.canvas,n=e.scene;k(n),n.getEngine().loadingScreen=new S;var i=new E.d("camera1",Math.PI/2,Math.PI/2,9,E.w.Zero(),n);i.minZ=.001,i.lowerRadiusLimit=9,i.upperRadiusLimit=9,n.activeCameras.push(i),i.attachControl(t,!0),new E.k("light1",E.w.Up(),n).intensity=.7;var s=new E.m("background","/assets/images/jeremy-perkins-uhjiu8FjnsQ-unsplash.jpg",n);s.isBackground=!0,s.texture.level=0,s.texture.wAng=.2,_(n).then((function(e){I(!0),H(a,n,e)})),n.onBeforeRenderObservable.add((function(){var e=n.getEngine().getDeltaTime();g.a.each(n.meshes,(function(t){t.rotation.y+=2/60*Math.PI*2*(e/1e3),t.rotation.z+=2/60*Math.PI*2*(e/1e3)}))}))}})),D&&s.a.createElement("div",{className:"ui"},s.a.createElement("div",{className:"uiElement shipName"},T[a].name),s.a.createElement("div",{className:"uiElement sideBox shipStats"},s.a.createElement("div",null,"HP: ",T[a].stats.hp),s.a.createElement("div",null,"Attack: ",T[a].stats.attack.base," - ",T[a].stats.attack.base+T[a].stats.attack.variable),s.a.createElement("div",null,"Defence: ",T[a].stats.defence),s.a.createElement("div",null,"Speed: ",T[a].stats.speed),s.a.createElement("div",null,"Range: ",T[a].stats.range),s.a.createElement("div",null,"Accuracy: ",T[a].stats.accuracy),s.a.createElement("div",null,"Agility: ",T[a].stats.agility)),s.a.createElement("div",{className:"uiElement sideBox shipControls"},s.a.createElement("div",{className:V,onClick:function(){var t=T[a].stats.cp;B(l)+t<=e.maxCp&&(l[a]=(l[a]||0)+1,m(l),h(B(l))),A(!1)}},"+"),s.a.createElement("div",null,"Max CP: ",s.a.createElement("span",{className:"maxCp"},e.maxCp)),s.a.createElement("div",null,"CP Cost: ",T[a].stats.cp),s.a.createElement("div",null,"Used ships: ",l[a]||0),s.a.createElement("div",null,"Used CP: ",d),s.a.createElement("div",{className:"addOrRemoveShip removeShip",onClick:function(){l[a]>0&&(l[a]--,m(l),h(B(l)))}},"-")),s.a.createElement("div",{className:"uiElement shipDescription"},T[a].description),s.a.createElement("div",{className:"uiElement chevron left",onClick:function(){var e=a-1,t=e<0?T.length-1:e;r(t),H(t,w)}}),s.a.createElement("div",{className:"uiElement chevron right",onClick:function(){var e=a+1,t=e>=T.length?0:e;r(t),H(t,w)}}),s.a.createElement("div",{className:"uiElement doneBox",onClick:function(){var t=d<e.maxCp;A(t),t||F()}},"DONE"),s.a.createElement("a",{className:"miniLogoBox",href:"/"}),s.a.createElement("div",{className:"omegaTip"},s.a.createElement("div",{className:"title"},"Ship Selection"),s.a.createElement("div",{className:"explanation"},s.a.createElement("div",{className:"tip"},"1. The amount of ships in a fight is determined by the Command Power (CP) of the Defender fleet."),s.a.createElement("div",{className:"tip"},"2. Each ship costs a certain amount of CP."),s.a.createElement("div",{className:"tip"},"3. The Attacker selects a fleet, the total CP of which can not exceed the total CP of the Defender.")))),R&&s.a.createElement("div",{className:"modal"},s.a.createElement("div",{className:"modal-popup"},s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"modal-title"},"You can still add ships to your fleet, Admiral!"),s.a.createElement("div",null,"Tip: Add ships to your fleet with the + button to the right of ship portrait.")),s.a.createElement("div",{className:"modal-buttons"},s.a.createElement("div",{className:"modal-button left",onClick:function(){A(!1)}},"Back"),s.a.createElement("div",{className:"modal-button right",onClick:function(){A(!1),F()}},"Start Anyway")))))}),k=0,N=1,C=2,M=3,O={0:"#73ffbe",1:"#2196F3",2:"#7B1FA2",3:"#FFD740"},x=[{name:"XT-101",asset:"assets/robot_5/",description:"Standard issue command robot issued to all Commanders. First and last iteration of its kind, provides slight bonuses to attack and defence.",stats:{attack:{modifier:2,vs:0},defence:{modifier:2,vs:0}},scale:10,visuals:{pickAnimations:["Ball_To_Stand","Idle","Idle_Look_Back","Idle_Look_Side"],positionOffset:new E.w(0,.8,0)},rarity:k},{name:"YT-106",asset:"assets/worker_12/",description:"Military grade command robot, in its sixth iteration. Smarter and more effective than the XT, is also known to be moody and disingenuous.",stats:{attack:{modifier:3,vs:1},defence:{modifier:3,vs:1}},scale:300,visuals:{},rarity:N},{name:"HV-12",asset:"assets/mech_walker/",description:"Since the entire series is classified, not much is known about the origins of this killing machine. It is clearly an assasination model.",stats:{attack:{modifier:4},defence:{modifier:3}},scale:300,visuals:{positionOffset:new E.w(0,-1.2,0),rotation:new E.w(0,0,0)},rarity:C},{name:"Magnus",asset:"assets/trooper/",description:"Cyborgs are the ultimate combination of human intuition and robot processing power. While lacking in empathy, they make for formiddable commanders.",stats:{attack:{modifier:10},defence:{modifier:5}},scale:60,visuals:{positionOffset:new E.w(0,-1.8,0)},rarity:M}],L=(n(494),function(e){var t=Object(i.useState)(0),n=Object(v.a)(t,2),a=n[0],r=n[1],o=Object(i.useState)(null),c=Object(v.a)(o,2),l=c[0],m=c[1],u=Object(i.useState)([]),p=Object(v.a)(u,2),d=p[0],h=p[1],y=Object(i.useState)(!1),f=Object(v.a)(y,2),w=f[0],k=f[1],N=function(e){return new Promise((function(t,n){var a=[],i=new E.e(e);g.a.each(x,(function(e,t){i.addMeshTask(t,"",x[t].asset,"scene.gltf").onSuccess=function(e){var n,i;a[t]=e.loadedMeshes,n=e.loadedMeshes,i=t,n[0].position=x[i].visuals.positionOffset||E.w.Zero(),n[0].rotation=x[i].visuals.rotation||new E.w(0,Math.PI,0),n[0].scalingDeterminant=.001*x[i].scale,n[0].isVisible=!1}})),i.onFinish=function(e){h(a),t(a)},i.load()}))},C=function(e,t,n){var a=n||d;g.a.each(t.meshes,(function(e){e.isVisible=!1})),g.a.each(a[e],(function(e){e.isVisible=!0})),g.a.invoke(g.a.filter(t.animationGroups,(function(t){return g.a.contains(x[e].visuals.pickAnimations,t.name)})),"play",!0)},M=O[x[a].rarity],L={0:"Common",1:"Rare",2:"Epic",3:"Legendary"}[x[a].rarity]||"",D=g.a.has(x[a].stats.attack,"vs")?" vs ".concat(T[x[a].stats.attack.vs].name):"",I="+".concat(x[a].stats.attack.modifier).concat(D),j=g.a.has(x[a].stats.defence,"vs")?" vs ".concat(T[x[a].stats.defence.vs].name):"",P="+".concat(x[a].stats.defence.modifier).concat(j);return s.a.createElement("div",{className:"CommanderSelection"},s.a.createElement(b.a,{antialias:!0,adaptToDeviceRatio:!0,canvasId:"ship-selection"},s.a.createElement(b.b,{onSceneMount:function(e){var t=e.canvas,n=e.scene;m(n),n.getEngine().loadingScreen=new S;var i=new E.d("camera1",Math.PI/2,Math.PI/2,9,E.w.Zero(),n);i.minZ=.001,i.upperAlphaLimit=Math.PI/2,i.lowerAlphaLimit=Math.PI/2,i.upperBetaLimit=Math.PI/2,i.lowerBetaLimit=Math.PI/2,i.lowerRadiusLimit=9,i.upperRadiusLimit=9,n.activeCameras.push(i),i.attachControl(t,!0),new E.k("light1",E.w.Up(),n).intensity=.7;var s=new E.m("background","/assets/images/jeremy-perkins-uhjiu8FjnsQ-unsplash.jpg",n);s.isBackground=!0,s.texture.level=0,s.texture.wAng=.2,N(n).then((function(e){k(!0),C(a,n,e)}))}})),w&&s.a.createElement("div",{className:"ui"},s.a.createElement("div",{className:"uiElement commanderName",style:{color:M}},x[a].name),s.a.createElement("div",{className:"uiElement sideBox commanderStats"},s.a.createElement("div",null,"Rarity: ",s.a.createElement("span",{style:{color:M}},L)),s.a.createElement("div",null,"Level: 1"),s.a.createElement("div",null,"Experience: 0/1000")),s.a.createElement("div",{className:"uiElement sideBox commanderControls"},s.a.createElement("div",null,"Attack:",s.a.createElement("div",null,I)),s.a.createElement("div",null,"Defence:",s.a.createElement("div",null,P))),s.a.createElement("div",{className:"uiElement commanderDescription"},x[a].description),s.a.createElement("div",{className:"uiElement chevron left",onClick:function(){var e=a-1,t=e<0?x.length-1:e;r(t),C(t,l)}}),s.a.createElement("div",{className:"uiElement chevron right",onClick:function(){var e=a+1,t=e>=x.length?0:e;r(t),C(t,l)}}),s.a.createElement("div",{className:"uiElement doneBox",onClick:function(){e.onDone(a)}},"DONE"),s.a.createElement("a",{className:"miniLogoBox",href:"/"}),s.a.createElement("div",{className:"omegaTip"},s.a.createElement("div",{className:"title"},"Commander Selection"),s.a.createElement("div",{className:"explanation"},s.a.createElement("div",{className:"tip"},"1. Each fleet in a fight is led by a Commander."),s.a.createElement("div",{className:"tip"},"2. Commanders have different stats, skills, and rarity levels."),s.a.createElement("div",{className:"tip"},"3. By winning in Ranked Combat, Commanders increase their experience and effectiveness.")))))}),D=(n(495),function(e){var t=Object(i.useState)(0),n=Object(v.a)(t,2),a=n[0],r=n[1],o=Object(i.useState)(!1),c=Object(v.a)(o,2),l=c[0],m=c[1],u=Object(i.useState)(""),p=Object(v.a)(u,2),d=p[0],h=p[1],y=Object(i.useState)(!1),f=Object(v.a)(y,2),w=f[0],k=f[1],N=[],C=[],M=function(e,t,n,a,i,s,r){t[0].position=new E.w(a+n*s,0,.2*-n),t[0].rotation=new E.w(2*Math.PI,Math.PI/2*s,Math.PI/2*-s),t[0].scalingDeterminant=13e-5*T[n].scale,g.a.each(t,(function(t){t.material=new E.v(g.a.uniqueId(),e),t.material.diffuseColor=r?new E.h(0,1,0):new E.h(1,1,0)})),r?N[n]=[t[0]]:C[n]=[t[0]];for(var o=0;o<i-1;o++){var c=t[0].clone();o%2===0?c.position.y-=(Math.floor(o/2)+1)*T[n].combatScale:c.position.y+=(Math.floor(o/2)+1)*T[n].combatScale,r?N[n].push(c):C[n].push(c)}},O="",L=function(e,t,n){var a=n?N:C,i=n?C:N;g.a.each(a[t.source],(function(n,a){if(i[t.target]&&i[t.target].length){var s=a%i[t.target].length,r=i[t.target][s];!function(e,t,n,a){var i=new E.v("laserMat",e);i.alpha=.8,i.diffuseColor=T[t].visuals.beamColor,i.backFaceCulling=!1;var s=E.n.CreateTube("laser",[n.position,a.position],T[t].visuals.beamWidth,64,null,0,e,!1,E.n.FRONTSIDE);s.material=i,s.convertToFlatShadedMesh(),setTimeout((function(){s.dispose()}),500)}(e,t.source,n,r)}}))},D=function(e,t,n,a,i){var s=function s(r,o){var c=t[r];if(!c)return o();("move"===c.moveType?function(e,t,n){var a=n?N[t.source]:C[t.source];return Promise.all(g.a.map(a,(function(a){return new Promise((function(i){var s=new E.c(g.a.uniqueId(),"position.x",10,E.c.ANIMATIONTYPE_FLOAT,E.c.ANIMATIONLOOPMODE_CONSTANT),r=n?-1:1,o=[{frame:0,value:a.position.x},{frame:10,value:a.position.x+Math.abs(t.targetPosition-a.position.x)*r},{frame:20,value:t.targetPosition}];s.setKeys(o),a.animations=[s],e.beginAnimation(a,0,20,!1,2,i)}))})))}(e,c,n):new Promise((function(t,s){L(e,c,n),(n?i:a)[c.target]-=c.damage,function(e,t,n,a,i){for(var s=T[t].stats.hp,r=n?i[t]:a[t],o=Math.max(Math.ceil(r/s),0),c=n?C[t]:N[t],l=c.length-o,m=function(t){var n=c.shift();E.p.CreateAsync("explosion",e).then((function(e){e.systems.forEach((function(e){e.worldOffset=n.position,e.disposeOnStop=!0,e.maxSize=.01,e.minSize=.001})),e.systems=[e.systems[0]],e.start()})),n.dispose()},u=0;u<l;u++)m()}(e,c.target,n,a,i),function(e,t){var n="".concat(t?"[Attacker]":"[Defender]"," ").concat(T[e.source].name," hits ").concat(T[e.target].name," for ").concat(e.damage," damage.");h(O=n+"\n"+O)}(c,n),setTimeout(t,500)}))).then((function(){r+1<t.length?s(r+1,o):o()}))};return new Promise((function(e,t){s(0,e)}))},I=function t(n,a,i,s){if(a>=e.result.rounds)m(!0);else{r(a),function(e){var t="Round ".concat(e+1," begins.\n\n");h(O=t+O)}(a);var o=g.a.filter(e.result.lhs,(function(e){return e.round===a&&!g.a.isEmpty(e.moveType)})),c=g.a.filter(e.result.rhs,(function(e){return e.round===a&&!g.a.isEmpty(e.moveType)}));D(n,o,!0,i,s).then((function(){D(n,c,!1,i,s).then((function(){t(n,a+1,i,s)}))}))}},j=x[e.commanderLhs].asset+"thumb.png",P=x[e.commanderRhs].asset+"thumb.png";return s.a.createElement("div",{className:"Combat"},s.a.createElement(b.a,{antialias:!0,adaptToDeviceRatio:!0,canvasId:"combat"},s.a.createElement(b.b,{onSceneMount:function(t){var n=t.canvas,a=t.scene;a.getEngine().loadingScreen=new S;var i=new E.d("camera1",Math.PI/2,Math.PI/2+Math.PI/4,18.5,E.w.Zero(),a);i.minZ=.001,i.lowerRadiusLimit=18.5,i.upperRadiusLimit=18.5,a.activeCameras.push(i),i.attachControl(n,!0),new E.k("light1",new E.w(0,0,1),a).intensity=.7;var s=new E.m("background","/assets/images/jeremy-perkins-uhjiu8FjnsQ-unsplash.jpg",a);s.isBackground=!0,s.texture.level=0,s.texture.wAng=.2,function(t){return new Promise((function(n,a){var i=new E.e(t);g.a.each(e.selectionLhs,(function(e,n){e>0&&(N[n]=[],i.addMeshTask(n,"",T[n].asset,T[n].sceneFile||"scene.gltf").onSuccess=function(a){M(t,a.loadedMeshes,n,10,e,1,!0)})})),g.a.each(e.selectionRhs,(function(e,n){e>0&&(C[n]=[],i.addMeshTask(n,"",T[n].asset,"scene.gltf").onSuccess=function(a){M(t,a.loadedMeshes,n,-10,e,-1,!1)})})),i.onFinish=function(e){n()},i.load()}))}(a).then((function(){k(!0),function(t){var n=g.a.map(e.selectionLhs,(function(e,t){return T[t].stats.hp*e})),a=g.a.map(e.selectionRhs,(function(e,t){return T[t].stats.hp*e}));I(t,0,n,a)}(a)}))}})),w&&s.a.createElement("div",{className:"ui"},s.a.createElement("div",{className:"uiElement commander lhs"},s.a.createElement("img",{alt:"Commander",src:j})),s.a.createElement("div",{className:"uiElement commander rhs"},s.a.createElement("img",{alt:"Commander",src:P})),s.a.createElement("div",{className:"uiElement currentRound"},"Round ",a+1),s.a.createElement("div",{className:"uiElement combatLog"},s.a.createElement("pre",null,d)),s.a.createElement("div",{className:"uiElement doneBox",onClick:function(){m(!0)}},"FINISH"),s.a.createElement("div",{className:"miniLogoBox"}),l&&s.a.createElement("div",{className:"result"},s.a.createElement("div",{className:"resultDialog"},s.a.createElement("div",{className:"winner"},function(){var t=function(e){return!g.a.find(e,(function(e){return e>0}))};return t(e.result.lhsHp)?"Defender Wins":t(e.result.rhsHp)?"Attacker Wins":"Draw"}()),s.a.createElement("a",{className:"exitButton",href:"/"},"EXIT")))))}),I=(n(496),function(e){return s.a.createElement("div",{className:"OpponentSelection"},s.a.createElement("div",{className:"ui"},s.a.createElement("div",{className:"mainTitle"}),s.a.createElement("div",{className:"mainMenu"},g.a.map(e.opponents,(function(t,n){return s.a.createElement("div",{key:n,className:"mainMenuItem",onClick:function(){!function(t){e.onDone(t)}(t)}},t.name)}))),s.a.createElement("div",{className:"versionBox uiElement"},"Version: 0.0.1 (c) celrisen.eth"),s.a.createElement("div",{className:"ethBalance uiElement"}),s.a.createElement("a",{className:"miniLogoBox",href:"/"})))}),j=(n(497),function(e){return s.a.createElement("div",{className:"Leaderboard"},s.a.createElement("div",{className:"ui"},s.a.createElement("div",{className:"mainTitle"}),s.a.createElement("div",{className:"mainMenu"},g.a.map(e.leaderboard,(function(e,t){return s.a.createElement("div",{key:t,className:"mainMenuItem"},s.a.createElement("div",{className:"name"},e.name),s.a.createElement("div",{className:"address"},"Address: ",e.player),s.a.createElement("div",{className:"wins"},"Wins: ",e.wins.toNumber()),s.a.createElement("div",{className:"losses"},"Losses: ",e.losses.toNumber()))}))),s.a.createElement("div",{className:"versionBox uiElement"},"Version: 0.0.1 (c) celrisen.eth"),s.a.createElement("div",{className:"ethBalance uiElement"}),s.a.createElement("a",{className:"miniLogoBox",href:"/"})))}),P=(n(498),function(e){return s.a.createElement("div",{className:"ShowLogs"},s.a.createElement("div",{className:"ui"},s.a.createElement("div",{className:"mainTitle"}),s.a.createElement("div",{className:"mainMenu"},g.a.map(e.logs,(function(t,n){return s.a.createElement("div",{key:n,className:"mainMenuItem",onClick:function(){!function(t){e.onDone(t)}(t)}},s.a.createElement("span",{className:"address"},t.args[0]),s.a.createElement("span",{className:"vs"}," vs "),s.a.createElement("span",{className:"address"},t.args[1]))}))),s.a.createElement("div",{className:"versionBox uiElement"},"Version: 0.0.1 (c) celrisen.eth"),s.a.createElement("div",{className:"ethBalance uiElement"}),s.a.createElement("a",{className:"miniLogoBox",href:"/"})))}),R=function(e,t){var n,a=[10,11,12,13],i=[-10,-11,-12,-13],s=g.a.map(e,(function(e,t){return T[t].stats.hp*e||0})),r=g.a.map(t,(function(e,t){return T[t].stats.hp*e||0})),o=g.a.clone(s),c=g.a.clone(r),l=function(e,t,n,a){var i=t[e],s=g.a.map(n,(function(t,n){var s=Math.abs(i-t);return a[n]<=0||s>T[e].stats.range?Number.MAX_SAFE_INTEGER:s})),r=g.a.min(s),o=s.indexOf(r);return r===Number.MAX_SAFE_INTEGER?null:o},m=function(e){return l(e,a,i,c)},u=function(e){return l(e,i,a,o)},p=function(e,t,n,a){var i,s=(T[e].stats.attack.base+(i=T[e].stats.attack.variable,Math.floor(Math.random()*Math.floor(i)))-T[t].stats.defence)*(100-T[t].stats.agility)*(n/a),r=Math.ceil(n/T[e].stats.hp)*T[t].stats.hp;return Math.min(Math.floor(Math.max(0,s)),r)},d=function(e){return!(Math.abs(e)>15)&&(!g.a.find(a,(function(t,n){return t===e&&o[n]>0}))&&!g.a.find(i,(function(t,n){return t===e&&c[n]>0})))},h=function(e,t,n){for(var a=T[t].stats.speed;a>0;a--){var i=e[t]+n*a;if(d(i)){e[t]=i;break}}return e[t]},y=function(e){return h(i,e,1)},f=[],v=[],b=function(e,t,n,a,i){t.push({moveType:"shoot",round:e,source:n,target:a,damage:i})},E=function(e,t,n,a){t.push({moveType:"move",round:e,source:n,targetPosition:a})},S=function(e,t,n,a){b(e,f,t,n,a)},w=function(e,t,n){E(e,f,t,n)},k=function(e,t,n,a){b(e,v,t,n,a)},N=function(e,t,n){E(e,v,t,n)};for(n=0;n<50&&g.a.find(o,(function(e){return e>0}))&&g.a.find(c,(function(e){return e>0}));n++){for(var C=0;C<T.length;C++)if(o[C]>0){var M=m(C);if(M||0===M){var O=p(C,M,o[C],s[C]);c[M]-=O,S(n,C,M,O)}else h(a,C,-1),w(n,C,a[C])}for(var x=0;x<T.length;x++)if(c[x]>0){var L=u(x);if(L||0===L){var D=p(x,L,c[x],r[x]);o[L]-=D,k(n,x,L,D)}else y(x),N(n,x,i[x])}}return{lhs:f,rhs:v,lhsHp:o,rhsHp:c,rounds:n}},A=0,B=1,F=2,_=3,H=4,V=5,W=6,U=7,Z=function(e){Object(h.a)(a,e);var t=Object(y.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).defaultLoadedState={mode:A,loading:!1,trainingSelfSelection:null,trainingResult:null,trainingSelfCommander:null,trainingOpponent:null,trainingOpponentSelection:null,trainingOpponentCommander:null,trainingCp:null,defenders:null,settingDefence:!1,settingAttack:!1},n.defaultUnloadedState={ownAccount:null,web3Loaded:!1,gameEngineContract:null,gameManagerContract:null},n.state=Object(u.a)(Object(u.a)({},n.defaultLoadedState),n.defaultUnloadedState),n}return Object(d.a)(a,[{key:"shipSelectionDone",value:function(e){var t=!this.state.settingDefence&&R(e,this.state.trainingOpponentSelection);this.setState({mode:F,trainingSelfSelection:e,trainingResult:t})}},{key:"commanderSelectionDone",value:function(){var e=Object(m.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.settingDefence){e.next=7;break}return this.setState({loading:!0}),e.next=4,this.state.gameManagerContract.registerDefence(this.state.trainingSelfSelection,t,this.state.ownAccount);case 4:this.setState(this.defaultLoadedState),e.next=15;break;case 7:if(!this.state.settingAttack){e.next=14;break}return this.setState({loading:!0}),e.next=11,this.state.gameManagerContract.attack(this.state.trainingOpponent,this.state.trainingSelfSelection,t);case 11:this.setState(this.defaultLoadedState),e.next=15;break;case 14:this.setState({mode:H,trainingSelfCommander:t});case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"commanderPreviewDone",value:function(){this.setState(this.defaultLoadedState)}},{key:"opponentSelectionDone",value:function(e){var t=e.defenceSelection;this.setState({mode:B,settingAttack:!0,trainingOpponent:e.player,trainingOpponentSelection:t,trainingOpponentCommander:e.commander,trainingCp:this._selectionToCp(t)})}},{key:"_selectionToCp",value:function(e){return g.a.reduce(e,(function(e,t,n){return e+(t||0)*T[n].stats.cp}),0)}},{key:"training",value:function(){var e=[25,18,16,6];this.setState({mode:B,trainingOpponentSelection:e,trainingCp:this._selectionToCp(e)})}},{key:"commanders",value:function(){this.setState({mode:_})}},{key:"defend",value:function(){var e=[25,18,16,6];this.setState({mode:B,settingDefence:!0,trainingOpponentSelection:e,trainingCp:this._selectionToCp(e)})}},{key:"showLogs",value:function(){var e=Object(m.a)(l.a.mark((function e(){var t,n,a,i=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.state.gameManagerContract.filters.FightComplete()).fromBlock=this.state.provider.getBlockNumber().then((function(e){return e-1e4})),t.toBlock="latest",t.attacker=this.state.ownAccount,this.setState({loading:!0}),e.next=7,this.state.provider.getLogs(t);case 7:n=e.sent,a=g.a.map(n,(function(e){return i.state.gameManagerContract.interface.parseLog(e)})),this.setState({mode:W,logs:a,loading:!1});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"logSelectionDone",value:function(e){var t=e.args[2],n=function(e){return g.a.map(e,(function(e){return Object(u.a)(Object(u.a)({},e),{},{damage:e.damage.toNumber()})}))},a=function(e){return g.a.map(e,(function(e){return e.toNumber()}))},i={lhs:n(t.lhs),rhs:n(t.rhs),lhsHp:a(t.lhsHp),rhsHp:a(t.rhsHp),rounds:t.rounds,selectionLhs:t.selectionLhs,selectionRhs:t.selectionRhs,commanderLhs:t.commanderLhs,commanderRhs:t.commanderRhs};this.setState({mode:H,trainingSelfSelection:i.selectionLhs,trainingSelfCommander:i.commanderLhs,trainingOpponentSelection:i.selectionRhs,trainingResult:i})}},{key:"attack",value:function(){var e=Object(m.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.state.gameManagerContract.getAllDefenders();case 3:t=e.sent,this.setState({mode:V,defenders:t,loading:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"leaderboard",value:function(){var e=Object(m.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,this.state.gameManagerContract.getLeaderboard();case 3:t=e.sent,this.setState({mode:U,leaderboard:t,loading:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return s.a.createElement("div",{className:"App"},this.state.mode===A&&s.a.createElement("div",{className:"mainScreen ui"},s.a.createElement("div",{className:"mainTitle"}),s.a.createElement("div",{className:"mainMenu"},s.a.createElement("div",{className:"mainMenuItem",onClick:this.training.bind(this)},"TRAINING"),s.a.createElement("div",{className:"mainMenuItem",onClick:this.commanders.bind(this)},"COMMANDERS"),s.a.createElement("div",{className:"mainMenuItem",onClick:this.showLogs.bind(this)},"LOGS"),s.a.createElement("div",{className:"mainMenuItem",onClick:this.defend.bind(this)},"DEFENCE"),s.a.createElement("div",{className:"mainMenuItem",onClick:this.attack.bind(this)},"ATTACK"),s.a.createElement("div",{className:"mainMenuItem",onClick:this.leaderboard.bind(this)},"LEADERBOARD")),s.a.createElement("div",{className:"versionBox uiElement"},"Version: 0.0.1 (c) celrisen.eth")),this.state.mode===B&&s.a.createElement(w,{maxCp:this.state.trainingCp,onDone:this.shipSelectionDone.bind(this)}),this.state.mode===F&&s.a.createElement(L,{onDone:this.commanderSelectionDone.bind(this)}),this.state.mode===_&&s.a.createElement(L,{onDone:this.commanderPreviewDone.bind(this)}),this.state.mode===H&&s.a.createElement(D,{selectionLhs:this.state.trainingSelfSelection,selectionRhs:this.state.trainingOpponentSelection,commanderLhs:this.state.trainingSelfCommander,commanderRhs:0,result:this.state.trainingResult}),this.state.mode===V&&s.a.createElement(I,{opponents:this.state.defenders,onDone:this.opponentSelectionDone.bind(this)}),this.state.mode===W&&s.a.createElement(P,{logs:this.state.logs,onDone:this.logSelectionDone.bind(this)}),this.state.mode===U&&s.a.createElement(j,{leaderboard:this.state.leaderboard}),s.a.createElement("div",{id:"omegaLoadingScreen",style:this.state.web3Loaded&&!this.state.loading?{display:"none"}:{}},s.a.createElement("div",{className:"logo"}),s.a.createElement("div",{className:"progressOuter progress-line"})))}},{key:"componentDidMount",value:function(){this._initWeb3()}},{key:"_initWeb3",value:function(){var e=Object(m.a)(l.a.mark((function e(){var t,n,a,i=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new f.a.providers.Web3Provider(window.ethereum),n=t.getSigner(),e.next=4,window.ethereum.send("eth_requestAccounts");case 4:a=e.sent,this.setState({provider:t,ownAccount:a.result[0],signer:n},(function(){i._loadContracts(n)}));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_loadContracts",value:function(e){var t=n(514),a=new f.a.Contract("0x39a3c0cDddF3f46A1b7462e911508E20230e6034",t,e),i=n(515),s=new f.a.Contract("0xc7ed5147cd9C348fdd3Fa954c3391597873ec010",i,e);this.setState({gameEngineContract:a,gameManagerContract:s,web3Loaded:!0})}}]),a}(i.Component);a.a({dsn:"https://adf39eeb31a04f4c9e2ae1613a647396@o509705.ingest.sentry.io/5604612",debug:!0,autoSessionTracking:!0,tracesSampleRate:1}),o.a.render(s.a.createElement(Z,null),document.getElementById("root"))}},[[471,1,2]]]);
//# sourceMappingURL=main.43c06112.chunk.js.map